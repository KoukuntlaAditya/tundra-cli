{"version":3,"sources":["../../src/server.js"],"names":["Socket","start","port","fixturesDirectory","server","use","json","static","join","__dirname","delete","post","get","listen","console","log","green","init","socketPort"],"mappings":";;;;;;;AAAA;;AACA;;;;AACA;;;;AACA;;;;AACA;;AAKA;;AACA;;;;AACA;;;;AACA;;AACA;;IAAYA,M;;AACZ;;;;AACA;;;;AACA;;;;;;;;;;AAEO,IAAMC;AAAA,qEAAQ,iBAAOC,IAAP,EAAaC,iBAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAEbC,kBAFa,GAEJ,wBAFI;;AAInB;;AACAA,mBAAOC,GAAP,CAAW,qBAAX;AACAD,mBAAOC,GAAP,CAAW,qBAAWC,IAAX,EAAX;;AAEA;AACAF,mBAAOC,GAAP,CAAW,kBAAQE,MAAR,CAAe,eAAKC,IAAL,CAAUC,YAAY,wBAAtB,CAAf,CAAX;;AAEA;AACAL,mBAAOM,MAAP,CAAc,WAAd;AACAN,mBAAOO,IAAP,CAAY,WAAZ;AACAP,mBAAOO,IAAP,CAAY,sBAAZ;AACAP,mBAAOO,IAAP,CAAY,gBAAZ;;AAEAP,mBAAOQ,GAAP,CAAW,WAAX;;AAEAR,mBAAOO,IAAP,CAAY,6BAAZ;AACAP,mBAAOM,MAAP,CAAc,QAAd;;AAEAN,mBAAOQ,GAAP,CAAW,WAAX;;AAEAR,mBAAOS,MAAP,CAAcX,IAAd,EAAoB;AAAA,qBAAMY,QAAQC,GAAR,CAAY,gBAAMC,KAAN,mEAA4Ed,IAA5E,OAAZ,CAAN;AAAA,aAApB;;AAEA;AA1BmB;AAAA,mBA2BMF,OAAOiB,IAAP,EA3BN;;AAAA;AA2BbC,sBA3Ba;;;AA6BnBJ,oBAAQC,GAAR,6BAAsCG,UAAtC;;AAEA,iCAAS,EAAEhB,UAAF,EAAQgB,sBAAR,EAAoBf,oCAApB,EAAT;;AAEA;AACAW,oBAAQC,GAAR;AACA,qDAAwBb,IAAxB;;AAnCmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAR;;AAAA;AAAA;AAAA;AAAA,GAAN","file":"server.js","sourcesContent":["import 'babel-polyfill';\nimport express from 'express';\nimport bodyParser from 'body-parser';\nimport chalk from 'chalk';\nimport {\n  handleRequest,\n  resetRequestsHandler,\n  saveRequestsHandler\n} from './handlers/requests';\nimport { startDebuggingRequest, stopDebuggingRequest } from './handlers/debugHandler';\nimport settingsHandler from './handlers/settings';\nimport profilesHandler from './handlers/profiles';\nimport { setState } from './services/state';\nimport * as Socket from './services/socket';\nimport opn from 'opn';\nimport cors from 'cors';\nimport path from 'path';\n\nexport const start = async (port, fixturesDirectory) => {\n\n  const server = express();\n\n  // Middleware\n  server.use(cors());\n  server.use(bodyParser.json());\n\n  // Console\n  server.use(express.static(path.join(__dirname + '../../../console/build')));\n\n  // Routes\n  server.delete('/requests', resetRequestsHandler);\n  server.post('/requests', handleRequest);\n  server.post('/requests/type/:type', handleRequest);\n  server.post('/requests/save', saveRequestsHandler);\n\n  server.get('/settings', settingsHandler);\n\n  server.post('/debug/profile/:profileName', startDebuggingRequest);\n  server.delete('/debug', stopDebuggingRequest);\n\n  server.get('/profiles', profilesHandler);\n\n  server.listen(port, () => console.log(chalk.green(`Tundra server started. Console available at http://localhost:${port}.`)));\n\n  // Websocket Server\n  const socketPort = await Socket.init();\n\n  console.log(`Socket started on port ${socketPort}. Waiting for client to join...`);\n\n  setState({ port, socketPort, fixturesDirectory });\n\n  // Launch Console\n  console.log(`Launching console...`);\n  opn(`http://localhost:${port}`);\n};\n\n\n"]}