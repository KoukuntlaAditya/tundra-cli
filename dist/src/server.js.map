{"version":3,"sources":["../../src/server.js"],"names":["Socket","start","port","fixturesDirectory","server","use","json","static","delete","post","get","listen","console","log","green","init","socketPort"],"mappings":";;;;;;;AAAA;;AACA;;;;AACA;;;;AACA;;;;AACA;;AAKA;;AACA;;;;AACA;;;;AACA;;AACA;;IAAYA,M;;AACZ;;;;AACA;;;;;;;;;;AAEO,IAAMC;AAAA,qEAAQ,iBAAOC,IAAP,EAAaC,iBAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAEbC,kBAFa,GAEJ,wBAFI;;AAInB;;AACAA,mBAAOC,GAAP,CAAW,qBAAX;AACAD,mBAAOC,GAAP,CAAW,qBAAWC,IAAX,EAAX;;AAEA;AACAF,mBAAOC,GAAP,CAAW,kBAAQE,MAAR,CAAe,eAAf,CAAX;;AAEA;AACAH,mBAAOI,MAAP,CAAc,WAAd;AACAJ,mBAAOK,IAAP,CAAY,WAAZ;AACAL,mBAAOK,IAAP,CAAY,iBAAZ;AACAL,mBAAOK,IAAP,CAAY,gBAAZ;;AAEAL,mBAAOM,GAAP,CAAW,WAAX;;AAEAN,mBAAOK,IAAP,CAAY,6BAAZ;AACAL,mBAAOI,MAAP,CAAc,QAAd;;AAEAJ,mBAAOM,GAAP,CAAW,WAAX;;AAEAN,mBAAOO,MAAP,CAAcT,IAAd,EAAoB;AAAA,qBAAMU,QAAQC,GAAR,CAAY,gBAAMC,KAAN,mEAA4EZ,IAA5E,OAAZ,CAAN;AAAA,aAApB;;AAEA;AA1BmB;AAAA,mBA2BMF,OAAOe,IAAP,EA3BN;;AAAA;AA2BbC,sBA3Ba;;;AA6BnBJ,oBAAQC,GAAR,6BAAsCG,UAAtC;;AAEA,iCAAS,EAAEd,UAAF,EAAQc,sBAAR,EAAoBb,oCAApB,EAAT;;AAEA;AACAS,oBAAQC,GAAR;AACA,qDAAwBX,IAAxB;;AAnCmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAR;;AAAA;AAAA;AAAA;AAAA,GAAN","file":"server.js","sourcesContent":["import 'babel-polyfill';\nimport express from 'express';\nimport bodyParser from 'body-parser';\nimport chalk from 'chalk';\nimport {\n  handleRequest,\n  resetRequestsHandler,\n  saveRequestsHandler\n} from './handlers/requests';\nimport { startDebuggingRequest, stopDebuggingRequest } from './handlers/debugHandler';\nimport settingsHandler from './handlers/settings';\nimport profilesHandler from './handlers/profiles';\nimport { setState } from './services/state';\nimport * as Socket from './services/socket';\nimport opn from 'opn';\nimport cors from 'cors';\n\nexport const start = async (port, fixturesDirectory) => {\n\n  const server = express();\n\n  // Middleware\n  server.use(cors());\n  server.use(bodyParser.json());\n\n  // Console\n  server.use(express.static('console/build'));\n\n  // Routes\n  server.delete('/requests', resetRequestsHandler);\n  server.post('/requests', handleRequest);\n  server.post('/requests/:type', handleRequest);\n  server.post('/requests/save', saveRequestsHandler);\n\n  server.get('/settings', settingsHandler);\n\n  server.post('/debug/profile/:profileName', startDebuggingRequest);\n  server.delete('/debug', stopDebuggingRequest);\n\n  server.get('/profiles', profilesHandler);\n\n  server.listen(port, () => console.log(chalk.green(`Tundra server started. Console available at http://localhost:${port}.`)));\n\n  // Websocket Server\n  const socketPort = await Socket.init();\n\n  console.log(`Socket started on port ${socketPort}. Waiting for client to join...`);\n\n  setState({ port, socketPort, fixturesDirectory });\n\n  // Launch Console\n  console.log(`Launching console...`);\n  opn(`http://localhost:${port}`);\n};\n\n\n"]}